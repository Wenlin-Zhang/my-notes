<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="A machine learning craftsmanship blog.">

    <title>Tutorial: Deep Learning in PyTorch - i am trask</title>

    <link rel="canonical" href="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/a_004.html">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/bootstrap.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/syntax.css">

    <!-- Custom Fonts -->
    <link rel="stylesheet" href="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/font-awesome.css">
    <link rel="stylesheet" href="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/css_002.css">
    <link rel="stylesheet" href="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/css.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

<script src="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/ca-pub-6751104560361558.js"></script><script async="" src="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/analytics.js"></script><script async="" src="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/analytics.js"></script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-36138203-3', 'auto');
  ga('send', 'pageview');

</script></head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top is-fixed is-visible">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://iamtrask.github.io/">i am trask</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="https://iamtrask.github.io/">Home</a>
                </li>
                
                <li>
                    <a href="https://iamtrask.github.io/about/">about</a>
                </li>
                
                <li>
                    <a href="https://iamtrask.github.io/contact/">Contact</a>
                </li>
                
                <li>
                    
                </li>
                
                <li>
                    
                </li>
                
                <li>
                    
                </li>
                
                <li>
                    
                </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-36138203-3', 'auto');
  ga('send', 'pageview');

</script>
<header class="intro-header" style="background-image: url('/img/stack_nebula.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Tutorial: Deep Learning in PyTorch</h1>
                    
                    <h2 class="subheading">An Unofficial Startup Guide.</h2>
                    
                    <span class="meta">Posted by iamtrask on January 15, 2017</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<p><b>EDIT:</b> <a href="http://pytorch.org/">A complete revamp of PyTorch</a>
 was released today (Jan 18, 2017), making this blogpost a bit obselete.
 I will update this post with a new Quickstart Guide soon, but for now 
you should check out their documentation.&lt;/a&gt;</p>

<p><b>This Blogpost Will Cover:</b></p>
<ul>
	<li>Part 1: PyTorch Installation</li>
	<li>Part 2: Matrices and Linear Algebra in PyTorch</li>
	<li>Part 3: Building a Feedforward Network (starting with <a href="https://iamtrask.github.io/2015/07/12/basic-python-network/"><u>a familiar one</u></a>)</li>
	<li>Part 4: The State of PyTorch</li>
</ul>

<p><b>Pre-Requisite Knowledge:</b></p>
<ul>
	<li>Simple Feedforward Neural Networks (<a href="https://iamtrask.github.io/2015/07/12/basic-python-network/"><u>Tutorial</u></a>)</li>
	<li>Basic Gradient Descent (<a href="http://iamtrask.github.io/2015/07/27/python-network-part2/"><u>Tutorial</u></a>)</li>
</ul>

<p><a href="http://torch.ch/">Torch</a> is one of the most popular Deep 
Learning frameworks in the world, dominating much of the research 
community for the past few years (only recently being rivaled by major 
Google sponsored frameworks <a href="https://www.tensorflow.org/">Tensorflow</a> and <a href="http://keras.io/">Keras</a>). Perhaps its only drawback to new users has been the fact that it requires one to know <a href="https://www.lua.org/">Lua</a>,
 a language that used to be very uncommon in the Machine Learning 
community. Even today, this barrier to entry can seem a bit much for 
many new to the field, who are already in the midst of learning a 
tremendous amount, much less a completely new programming language.</p>

<p>However, thanks to the wonderful and billiant <a href="https://github.com/hughperkins">Hugh Perkins</a>, Torch recently got a new face, <a href="https://github.com/hughperkins/pytorch">PyTorch</a>...
 and it's much more accessible to the python hacker turned Deep Learning
 Extraordinare than it's Luariffic cousin. I have a passion for tools 
that make Deep Learning accessible, and so I'd like to lay out a short 
"Unofficial Startup Guide" for those of you interested in taking it for a
 spin. Before we get started, however, a question:</p>

<p><b>Why Use a Framework like PyTorch? </b>In the past, I have 
advocated learning Deep Learning using only a matrix library. For the 
purposes of actually knowing what goes on under the hood, I think that 
this is essential, and the lessons learned from building things from 
scratch are real gamechangers when it comes to the messiness of tackling
 real world problems with these tools. However, when building neural 
networks in the wild (Kaggle Competitions, Production Systems, and 
Research Experiments), it's best to use a framework.</p>

<p><b>Why?</b> Frameworks such as PyTorch allow you (the researcher) to 
focus exclusively on your experiment and iterate very quickly. Want to 
swap out a layer? Most frameworks will let you do this with a single 
line code change. Want to run on a GPU? Many frameworks will take care 
of it (sometimes with 0 code changes). If you built the network by hand 
in a matrix library, you might be spending a few hours working out these
 kinds of modifications. So, for learning, use a linear algebra library 
(like Numpy). For applying, use a framework (like PyTorch). Let's get 
started!</p>

<p><b>For New Readers:</b> I typically tweet out new blogposts when they're complete <a href="https://twitter.com/iamtrask">@iamtrask</a>. Feel free to follow if you'd be interested in reading more in the future and thanks for all the upvotes on <a href="https://news.ycombinator.com/">Hacker News</a> and Reddit! They mean a lot to me.
</p>

<hr>

<script async="" src="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/adsbygoogle.js"></script>

<!-- Part 1 -->
<p><ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-6751104560361558" data-ad-slot="2365390629" data-adsbygoogle-status="done"><ins id="aswift_0_expand" style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent"><ins id="aswift_0_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;" width="728" height="90" frameborder="0"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<hr>

<h2 class="section-heading">Part 1: Installation</h2>

<p><b>Install Torch:</b> The first thing you need to do is install torch and the "nn" package using luarocks. As torch is a very robust framework, the <a href="http://torch.ch/docs/getting-started.html#_">installation instructions</a> should work well for you. After that, you should be able to run: </p>

<blockquote>luarocks install nn</blockquote>

<p> and be good to go. If any of these steps fails to work, copy paste 
what looks like the "error" and error description (should just be one 
sentence or so) from the command line and put it into Google (as is 
common practice when installing).</p>

<p><b>Clone the Repository: </b> At the time of writing, PyTorch doesn't
 seem to be in the PyPI repository. So, we'll need to clone the repo in 
order to install it. Assuming you have <a href="https://git-scm.com/">git</a> already installed (hint hint... if not go install it and come back), you should open up your <a href="http://www.macworld.co.uk/feature/mac-software/get-more-out-of-os-x-terminal-3608274/">Terminal</a>
 application and navigate to an empty folder. Personally, I have a 
folder called "Laboratory" in my home directory (i.e. "cd 
~/Laboratory/"), which cators to various <a href="https://en.wikipedia.org/wiki/Dexter%27s_Laboratory">childhood memories</a> of mine. If you're not sure where to put it, feel free to use your Desktop for now. Once there, execute the commands:</p>
<blockquote>
	git clone https://github.com/hughperkins/pytorch.git<br>
	cd pytorch/<br>
	pip install -r requirements.txt<br>
	pip install -r test/requirements.txt<br>
	source ~/torch/install/bin/torch-activate<br>
	./build.sh<br>
</blockquote>

<p>For me, this worked flawlessly, finishing with the statement</p>
<blockquote>
Finished processing dependencies for PyTorch===4.1.1-SNAPSHOT
</blockquote>

<p>If you also see this output at the bottom of your terminal, congraulations! You have successfully installed PyTorch!</p>

<p><b>Startup Jupyter Notebook:</b> While certainly not a requirement, I highly recommend playing around with this new tool using <a href="http://jupyter.readthedocs.io/en/latest/install.html">Jupyter Notebok</a>, which is <i>definitely</i> best <a href="http://jupyter.readthedocs.io/en/latest/install.html">installed using conda</a>. Take my word for it. Install it using conda. All other ways are madness.</p>

<hr>

<script async="" src="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/adsbygoogle.js"></script>

<!-- Part 1 -->
<p><ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-6751104560361558" data-ad-slot="2365390629" data-adsbygoogle-status="done"><ins id="aswift_1_expand" style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent"><ins id="aswift_1_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;" width="728" height="90" frameborder="0"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<hr>

<h2 class="section-heading">Part 2: Matrices and Linear Algebra</h2>

<p>In the spirit of starting with the basics, neural networks run on 
linear algebra libraries. PyTorch is no exception. So, the simplest 
building block of PyTorch is its linear algebra library. </p>

<p><img class="img-responsive" src="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/pytorch_1.png" alt="" width="100%"></p>

<p>Above, I created 4 matrices. Notice that the library doesn't call them matrices though. It calls them <i>tensors</i>.</p>

<p><b>Quick Primer on Tensors:</b> A <i>Tensor</i> is just a more generic term than <i>matrix</i> or <i>vector</i>.
 1-dimensional tensors are vectors. 2-dimensional tensors are matrices. 
3+ dimensional tensors are just refered to as tensors. If you're 
unfamiliar with these objects, here's a quick summary. A vector is "a 
list of numbers". A matrix is "a list of lists of numbers". A 3-d tensor
 is "a list of lists of lists of numbers". A 4-d tensor is... See the 
pattern? For more on how vectors and matrices are used to make neural 
networks, see my first blog post on a <a href="http://iamtrask.github.io/2015/07/12/basic-python-network/">Neural Network in 11 lines of Python</a></p>

<p><b>PyTorch Tensors</b> There appear to be 4 major types of tensors in PyTorch: Byte, Float, Double, and Long tensors. Each tensor <i>type</i>
 corresponds to the type of number (and more importantly the 
size/preision of the number) contained in each place of the matrix. So, 
if a 1-d Tensor is a "list of numbers", a 1-d <i>Float</i> Tensor is a list of <u>floats</u>.
 As a general rule of thumb, for weight matries we use FloatTensors. For
 data matrices, we'll likely use either FloatTensors (for real valued 
inputs) or Long Tensors (for integers). I'm a little bit surprised to 
not see IntTensor anywhere. Perhaps it has yet to be wrapped or is just 
non-obvious in the API.</p>

<p>The final thing to notice is that the matries seem to come with lots 
of rather random looking numbers inside (but not sensibly random like 
"evenly random between 0 and 1"). This is actually a plus of the library
 in my book. Let me explain (skip 1 paragraph if you're familiar with 
this concept)</p>

<p><b>Why Seemingly Nonsenical Values:</b> When you create a new matrix 
in PyTorch, the framework goes and "sets aside" enough RAM memory to 
store your matrix. However, "setting aside" memory is completely 
different from "changing all the values in that memory to  0". "Setting 
aside" memory while also "changing all the values to 0" is more 
computationally expensive. It's nice that this library doesn't assume 
you want the values to be any particular way. Instead, it just sets 
aside memory and whatever 1s and 0s happen to be there from the last 
program that used that piece of RAM will show up in your matrix. In most
 cases, we're going to set the values in our matrices to be something 
else anyway (say... our input data values or a specific kind of random 
number range). So, the fact that it doesn't pre-set the matrix values 
saves you a bit of processing time, but the user needs to recognize that
 it's their responsibility to actively choose the values he/she wants in
 a matrix. Numpy is not like this, which make Numpy a bit more user 
friendly but also less computationally efficient.</p>

<p><b>Basic Linear Algebra Operations:</b> So, now that we know how to 
store numbers in PyTorch, lets talk a bit about how PyTorch manipulates 
them. How does one go about doing linear algebra in PyTorch?</p>

<p><b>The Basic Neural Network Operations: </b> Neural networks, amidst all their complexity, are actually mostly made up of rather simple operations. If you remember from <a href="http://iamtrask.github.io/2015/07/12/basic-python-network/">A Neural Network in 11 Lines of Python</a>,
 we can build a working network with only Matrix-Matrix Multiplication, 
Vector-Matrix Multiplication, Elementwise Operations (addition, 
subtraction, multiplication, and division), Matrix Transposition, and a 
handful of elementwise functions (sigmoid, and a special function to 
compute sigmoid's derivative at a point which uses only the 
aforementioned elementwise operations). Let's initialize some matrices 
and start with the elementwise operations.</p>

<p><img class="img-responsive" src="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/pytorch_2.png" alt="" width="100%"></p>

<p><b>Elementwise Operations:</b> Above I have given several examples of
 elementwise addition. (simply replacing the "+" sign with - *  or / 
will give you the others). These act <i>mostly</i> how you would expect 
them to act. A few hiccups here and there. Notably, if you accidentally 
add two Tensors that aren't aligned correctly (have different 
dimensions) the python kernel crashes as opposed to throwing an error. 
It could be just my machine, but error handling in wrappers is 
notoriously time consuming to finish. I expect this functionality will 
be worked out soon enough, and as we will see, there's a suitable 
substitute. </p><p>

</p><p><b>Vector/Matrix Multiplication:</b> It appears that the native 
matrix multiplication functionality of Torch isn't wrapped. Instead, we 
get to use something a bit more familiar. (This feature is really, 
really cool.) <i>Much of PyTorch can run on native numpy matrices.</i> 
That's right! The convenient functionality of numpy is now integrated 
with one of the most popular Deep Learning Frameworks out there. So, how
 should you <i>really</i> do elementwise and matrix multipliplication? 
Just use numpy! For completeness sake, here's the same elementwise 
operations using PyTorch's numpy connector.</p>

<img class="img-responsive" src="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/pytorch_3.png" alt="" width="100%">

<p>And now let's see how to do the basic matrix operations we need for a feedforward network.</p>

<img class="img-responsive" src="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/pytorch_4.png" alt="" width="100%">

<p><b>Other Neural Functions:</b> Finally, we also need to be able to 
compute some nonlinearities efficiently. There are both numpy and native
 wrappers made available which seem to run quite fast. Additionally, 
sigmoid has a native implementation (something that numpy does not 
implement), which is quite nice and a bit faster than computing it 
explicitly in numpy.</p>

<img class="img-responsive" src="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/pytorch_5.png" alt="" width="100%">

<p>I consider the fantastic integration between numpy and PyTorch to be 
one of the great selling points of this framework. I personally love 
prototyping with the full control of a matrix library, and PyTorch 
really respects this preference as an option. This is so nice relative 
to most other frameworks out there. +1 for PyTorch.</p>

<hr>
<script async="" src="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/adsbygoogle.js"></script>
<!-- Part 1 -->
<ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-6751104560361558" data-ad-slot="2365390629" data-adsbygoogle-status="done"><ins id="aswift_2_expand" style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent"><ins id="aswift_2_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_2" name="aswift_2" style="left:0;position:absolute;top:0;" width="728" height="90" frameborder="0"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<hr>


<h2 class="section-heading">Part 3: Building a Feedforward Network</h2>

<p>In this section, we really get to start seeing PyTorch shine. While 
understanding how matrices are handled is an important pre-requisite to 
learning a framework, the various layers of abstraction are where 
frameworks really become useful. In this section, we're going to take 
the bare bones 3 layer neural network from <a href="http://iamtrask.github.io/2015/07/12/basic-python-network/">a previous blogpost</a>
 and convert it to a network using PyTorch's neural network 
abstractions. In this way, as we wrap each part of the network with a 
piece of framework functionality, you'll know exactly what PyTorch is 
doing under the hood. Your goal in this section should be to relate the 
PyTorch abstractions (objects, function calls, etc.) in the PyTorch 
network we will build with the matrix operations in the numpy neural 
network (pictured below)s. </p>

<div class="syntaxhighlighter " id="highlighter_248764"><div class="bar"><div class="toolbar"><a href="#viewSource" title="view source" style="width: 16px; height: 16px;" class="item viewSource">view source</a><a href="#printSource" title="print" style="width: 16px; height: 16px;" class="item printSource">print</a><a href="#about" title="?" style="width: 16px; height: 16px;" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><code class="number">01.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="keyword">import</code> <code class="plain">PyTorch</code></span></span></div><div class="line alt2"><code class="number">02.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="keyword">from</code> <code class="plain">PyTorch </code><code class="keyword">import</code> <code class="plain">np</code></span></span></div><div class="line alt1"><code class="number">03.</code><span class="content"><span class="block" style="margin-left: 0px;">&nbsp;</span></span></div><div class="line alt2"><code class="number">04.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="keyword">def</code> <code class="plain">nonlin(x,deriv</code><code class="keyword">=</code><code class="color1">False</code><code class="plain">):</code></span></span></div><div class="line alt1"><code class="number">05.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="keyword">if</code><code class="plain">(deriv</code><code class="keyword">=</code><code class="keyword">=</code><code class="color1">True</code><code class="plain">):</code></span></span></div><div class="line alt2"><code class="number">06.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 96px;"><code class="keyword">return</code> <code class="plain">x</code><code class="keyword">*</code><code class="plain">(</code><code class="value">1</code><code class="keyword">-</code><code class="plain">x)</code></span></span></div><div class="line alt1"><code class="number">07.</code><span class="content"><span class="block" style="margin-left: 0px;">&nbsp;</span></span></div><div class="line alt2"><code class="number">08.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="keyword">return</code> <code class="value">1</code><code class="keyword">/</code><code class="plain">(</code><code class="value">1</code><code class="keyword">+</code><code class="plain">np.exp(</code><code class="keyword">-</code><code class="plain">x))</code></span></span></div><div class="line alt1"><code class="number">09.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;">&nbsp;</span></span></div><div class="line alt2"><code class="number">10.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">X </code><code class="keyword">=</code> <code class="plain">np.array([[</code><code class="value">0</code><code class="plain">,</code><code class="value">0</code><code class="plain">,</code><code class="value">1</code><code class="plain">],</code></span></span></div><div class="line alt1"><code class="number">11.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px;"><code class="plain">[</code><code class="value">0</code><code class="plain">,</code><code class="value">1</code><code class="plain">,</code><code class="value">1</code><code class="plain">],</code></span></span></div><div class="line alt2"><code class="number">12.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px;"><code class="plain">[</code><code class="value">1</code><code class="plain">,</code><code class="value">0</code><code class="plain">,</code><code class="value">1</code><code class="plain">],</code></span></span></div><div class="line alt1"><code class="number">13.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px;"><code class="plain">[</code><code class="value">1</code><code class="plain">,</code><code class="value">1</code><code class="plain">,</code><code class="value">1</code><code class="plain">]])</code></span></span></div><div class="line alt2"><code class="number">14.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 192px;">&nbsp;</span></span></div><div class="line alt1"><code class="number">15.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">y </code><code class="keyword">=</code> <code class="plain">np.array([[</code><code class="value">0</code><code class="plain">],</code></span></span></div><div class="line alt2"><code class="number">16.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px;"><code class="plain">[</code><code class="value">1</code><code class="plain">],</code></span></span></div><div class="line alt1"><code class="number">17.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px;"><code class="plain">[</code><code class="value">1</code><code class="plain">],</code></span></span></div><div class="line alt2"><code class="number">18.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px;"><code class="plain">[</code><code class="value">0</code><code class="plain">]])</code></span></span></div><div class="line alt1"><code class="number">19.</code><span class="content"><span class="block" style="margin-left: 0px;">&nbsp;</span></span></div><div class="line alt2"><code class="number">20.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">np.random.seed(</code><code class="value">1</code><code class="plain">)</code></span></span></div><div class="line alt1"><code class="number">21.</code><span class="content"><span class="block" style="margin-left: 0px;">&nbsp;</span></span></div><div class="line alt2"><code class="number">22.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="comments"># randomly initialize our weights with mean 0</code></span></span></div><div class="line alt1"><code class="number">23.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">syn0 </code><code class="keyword">=</code> <code class="value">2</code><code class="keyword">*</code><code class="plain">np.random.random((</code><code class="value">3</code><code class="plain">,</code><code class="value">4</code><code class="plain">)) </code><code class="keyword">-</code> <code class="value">1</code></span></span></div><div class="line alt2"><code class="number">24.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">syn1 </code><code class="keyword">=</code> <code class="value">2</code><code class="keyword">*</code><code class="plain">np.random.random((</code><code class="value">4</code><code class="plain">,</code><code class="value">1</code><code class="plain">)) </code><code class="keyword">-</code> <code class="value">1</code></span></span></div><div class="line alt1"><code class="number">25.</code><span class="content"><span class="block" style="margin-left: 0px;">&nbsp;</span></span></div><div class="line alt2"><code class="number">26.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="keyword">for</code> <code class="plain">j </code><code class="keyword">in</code> <code class="plain">range(</code><code class="value">60000</code><code class="plain">):</code></span></span></div><div class="line alt1"><code class="number">27.</code><span class="content"><span class="block" style="margin-left: 0px;">&nbsp;</span></span></div><div class="line alt2"><code class="number">28.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="comments"># Feed forward through layers 0, 1, and 2</code></span></span></div><div class="line alt1"><code class="number">29.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="plain">l0 </code><code class="keyword">=</code> <code class="plain">X</code></span></span></div><div class="line alt2"><code class="number">30.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="plain">l1 </code><code class="keyword">=</code> <code class="plain">nonlin(np.dot(l0,syn0))</code></span></span></div><div class="line alt1"><code class="number">31.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="plain">l2 </code><code class="keyword">=</code> <code class="plain">nonlin(np.dot(l1,syn1))</code></span></span></div><div class="line alt2"><code class="number">32.</code><span class="content"><span class="block" style="margin-left: 0px;">&nbsp;</span></span></div><div class="line alt1"><code class="number">33.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="comments"># how much did we miss the target value?</code></span></span></div><div class="line alt2"><code class="number">34.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="plain">l2_error </code><code class="keyword">=</code> <code class="plain">y </code><code class="keyword">-</code> <code class="plain">l2</code></span></span></div><div class="line alt1"><code class="number">35.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;">&nbsp;</span></span></div><div class="line alt2"><code class="number">36.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="keyword">if</code> <code class="plain">(j</code><code class="keyword">%</code> <code class="value">10000</code><code class="plain">) </code><code class="keyword">=</code><code class="keyword">=</code> <code class="value">0</code><code class="plain">:</code></span></span></div><div class="line alt1"><code class="number">37.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 96px;"><code class="keyword">print</code><code class="plain">(</code><code class="string">"Error:"</code> <code class="keyword">+</code> <code class="plain">str(np.mean(np.abs(l2_error))))</code></span></span></div><div class="line alt2"><code class="number">38.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 96px;">&nbsp;</span></span></div><div class="line alt1"><code class="number">39.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="comments"># in what direction is the target value?</code></span></span></div><div class="line alt2"><code class="number">40.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="comments"># were we really sure? if so, don't change too much.</code></span></span></div><div class="line alt1"><code class="number">41.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="plain">l2_delta </code><code class="keyword">=</code> <code class="plain">l2_error</code><code class="keyword">*</code><code class="plain">nonlin(l2,deriv</code><code class="keyword">=</code><code class="color1">True</code><code class="plain">)</code></span></span></div><div class="line alt2"><code class="number">42.</code><span class="content"><span class="block" style="margin-left: 0px;">&nbsp;</span></span></div><div class="line alt1"><code class="number">43.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="comments"># how much did each l1 value contribute to the l2 error (according to the weights)?</code></span></span></div><div class="line alt2"><code class="number">44.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="plain">l1_error </code><code class="keyword">=</code> <code class="plain">l2_delta.dot(syn1.T)</code></span></span></div><div class="line alt1"><code class="number">45.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;">&nbsp;</span></span></div><div class="line alt2"><code class="number">46.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="comments"># in what direction is the target l1?</code></span></span></div><div class="line alt1"><code class="number">47.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="comments"># were we really sure? if so, don't change too much.</code></span></span></div><div class="line alt2"><code class="number">48.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="plain">l1_delta </code><code class="keyword">=</code> <code class="plain">l1_error </code><code class="keyword">*</code> <code class="plain">nonlin(l1,deriv</code><code class="keyword">=</code><code class="color1">True</code><code class="plain">)</code></span></span></div><div class="line alt1"><code class="number">49.</code><span class="content"><span class="block" style="margin-left: 0px;">&nbsp;</span></span></div><div class="line alt2"><code class="number">50.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="comments"># lets update our weights</code></span></span></div><div class="line alt1"><code class="number">51.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="plain">syn1 </code><code class="keyword">+</code><code class="keyword">=</code> <code class="plain">l1.T.dot(l2_delta)</code></span></span></div><div class="line alt2"><code class="number">52.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="plain">syn0 </code><code class="keyword">+</code><code class="keyword">=</code> <code class="plain">l0.T.dot(l1_delta)</code></span></span></div></div></div>
<!-- <h3>Runtime Output:</h3> -->
<pre>Error:0.496410031903
Error:0.00858452565325
Error:0.00578945986251
Error:0.00462917677677
Error:0.00395876528027
Error:0.00351012256786
</pre>

<p>Now that we've seen how to build this network (more or less "by 
hand"), let's starting building the same network using PyTorch instead 
of numpy.</p>

<div class="syntaxhighlighter " id="highlighter_632840"><div class="bar"><div class="toolbar"><a href="#viewSource" title="view source" style="width: 16px; height: 16px;" class="item viewSource">view source</a><a href="#printSource" title="print" style="width: 16px; height: 16px;" class="item printSource">print</a><a href="#about" title="?" style="width: 16px; height: 16px;" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><code class="number">1.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="keyword">import</code> <code class="plain">PyTorch</code></span></span></div><div class="line alt2"><code class="number">2.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="keyword">from</code> <code class="plain">PyTorchAug </code><code class="keyword">import</code> <code class="plain">nn</code></span></span></div><div class="line alt1"><code class="number">3.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="keyword">from</code> <code class="plain">PyTorch </code><code class="keyword">import</code> <code class="plain">np</code></span></span></div></div></div>

<p>First, we want to import several packages from PyTorch. <i>np</i> is the numpy wrapper mentioned before. <i>nn</i> is the <i>Neural Network</i> package, which contains things like layer types, error measures, and network containers, as we'll see in a second.</p>

<div class="syntaxhighlighter " id="highlighter_75853"><div class="bar"><div class="toolbar"><a href="#viewSource" title="view source" style="width: 16px; height: 16px;" class="item viewSource">view source</a><a href="#printSource" title="print" style="width: 16px; height: 16px;" class="item printSource">print</a><a href="#about" title="?" style="width: 16px; height: 16px;" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><code class="number">1.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="comments"># randomly initialize our weights with mean 0</code></span></span></div><div class="line alt2"><code class="number">2.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">net </code><code class="keyword">=</code> <code class="plain">nn.Sequential()</code></span></span></div><div class="line alt1"><code class="number">3.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">net.add(nn.Linear(</code><code class="value">3</code><code class="plain">, </code><code class="value">4</code><code class="plain">))</code></span></span></div><div class="line alt2"><code class="number">4.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">net.add(nn.Sigmoid())</code></span></span></div><div class="line alt1"><code class="number">5.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">net.add(nn.Linear(</code><code class="value">4</code><code class="plain">, </code><code class="value">1</code><code class="plain">))</code></span></span></div><div class="line alt2"><code class="number">6.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">net.add(nn.Sigmoid())</code></span></span></div><div class="line alt1"><code class="number">7.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">net.float()</code></span></span></div></div></div>

<p>The next section highlights the primary advantage of deep learning 
frameworks in general. Instead of declaring a bunch of weight matrices 
(like with numpy), we create layers and "glue" them together using 
nn.Sequential(). Contained in these "layer" objects is logic about how 
the layers are constructed, how each layer forward propagates 
predictions, and how each layer backpropagates gradients. 
nn.Sequential() knows how to combine these layers together to allow them
 to learn together when presented with a dataset, which is what we'll do
 next.</p>

<div class="syntaxhighlighter " id="highlighter_385381"><div class="bar"><div class="toolbar"><a href="#viewSource" title="view source" style="width: 16px; height: 16px;" class="item viewSource">view source</a><a href="#printSource" title="print" style="width: 16px; height: 16px;" class="item printSource">print</a><a href="#about" title="?" style="width: 16px; height: 16px;" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><code class="number">01.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">X </code><code class="keyword">=</code> <code class="plain">np.array([[</code><code class="value">0</code><code class="plain">,</code><code class="value">0</code><code class="plain">,</code><code class="value">1</code><code class="plain">],</code></span></span></div><div class="line alt2"><code class="number">02.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px;"><code class="plain">[</code><code class="value">0</code><code class="plain">,</code><code class="value">1</code><code class="plain">,</code><code class="value">1</code><code class="plain">],</code></span></span></div><div class="line alt1"><code class="number">03.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px;"><code class="plain">[</code><code class="value">1</code><code class="plain">,</code><code class="value">0</code><code class="plain">,</code><code class="value">1</code><code class="plain">],</code></span></span></div><div class="line alt2"><code class="number">04.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px;"><code class="plain">[</code><code class="value">1</code><code class="plain">,</code><code class="value">1</code><code class="plain">,</code><code class="value">1</code><code class="plain">]]).astype(</code><code class="string">'float32'</code><code class="plain">)</code></span></span></div><div class="line alt1"><code class="number">05.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 192px;">&nbsp;</span></span></div><div class="line alt2"><code class="number">06.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">y </code><code class="keyword">=</code> <code class="plain">np.array([[</code><code class="value">0</code><code class="plain">],</code></span></span></div><div class="line alt1"><code class="number">07.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px;"><code class="plain">[</code><code class="value">1</code><code class="plain">],</code></span></span></div><div class="line alt2"><code class="number">08.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px;"><code class="plain">[</code><code class="value">1</code><code class="plain">],</code></span></span></div><div class="line alt1"><code class="number">09.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px;"><code class="plain">[</code><code class="value">0</code><code class="plain">]]).astype(</code><code class="string">'float32'</code><code class="plain">)</code></span></span></div></div></div>

<p>This section is largely the same as before. We create our input (X) 
and output (y) datasets as numpy matrices. PyTorch seemed to want these 
matrices to be float32 values in order to do the implicit cast from 
numpy to PyTorch tensor objects well, so I added an .astype('float32') 
to ensure they were the right type.</p>

<div class="syntaxhighlighter " id="highlighter_926338"><div class="bar"><div class="toolbar"><a href="#viewSource" title="view source" style="width: 16px; height: 16px;" class="item viewSource">view source</a><a href="#printSource" title="print" style="width: 16px; height: 16px;" class="item printSource">print</a><a href="#about" title="?" style="width: 16px; height: 16px;" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><code class="number">1.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">crit </code><code class="keyword">=</code> <code class="plain">nn.MSECriterion()</code></span></span></div><div class="line alt2"><code class="number">2.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">crit.float()</code></span></span></div></div></div>

<p>This one might look a little strange if you're not familiar with 
neural network error measures. As it turns out, you can measure "how 
much you missed" in a variety of different ways. How you measure error 
changes how a network prioritizes different errors when training (what 
kinds of errors should it take most seriously). In this case, we're 
going to use the "Mean Squared Error". For a more in-depth coverage of 
this, please see Chapter 4 of <a href="https://www.manning.com/books/grokking-deep-learning">Grokking Deep Learning</a>.

</p><div class="syntaxhighlighter " id="highlighter_363330"><div class="bar"><div class="toolbar"><a href="#viewSource" title="view source" style="width: 16px; height: 16px;" class="item viewSource">view source</a><a href="#printSource" title="print" style="width: 16px; height: 16px;" class="item printSource">print</a><a href="#about" title="?" style="width: 16px; height: 16px;" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><code class="number">01.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="keyword">for</code> <code class="plain">j </code><code class="keyword">in</code> <code class="plain">range(</code><code class="value">2400</code><code class="plain">):</code></span></span></div><div class="line alt2"><code class="number">02.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;">&nbsp;</span></span></div><div class="line alt1"><code class="number">03.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="plain">net.zeroGradParameters()</code></span></span></div><div class="line alt2"><code class="number">04.</code><span class="content"><span class="block" style="margin-left: 0px;">&nbsp;</span></span></div><div class="line alt1"><code class="number">05.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="comments"># Feed forward through layers 0, 1, and 2</code></span></span></div><div class="line alt2"><code class="number">06.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="plain">output </code><code class="keyword">=</code> <code class="plain">net.forward(X)</code></span></span></div><div class="line alt1"><code class="number">07.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;">&nbsp;</span></span></div><div class="line alt2"><code class="number">08.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="comments"># how much did we miss the target value?</code></span></span></div><div class="line alt1"><code class="number">09.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="plain">loss </code><code class="keyword">=</code> <code class="plain">crit.forward(output, y)</code></span></span></div><div class="line alt2"><code class="number">10.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="plain">gradOutput </code><code class="keyword">=</code> <code class="plain">crit.backward(output, y)</code></span></span></div><div class="line alt1"><code class="number">11.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;">&nbsp;</span></span></div><div class="line alt2"><code class="number">12.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="comments"># how much did each l1 value contribute to the l2 error (according to the weights)?</code></span></span></div><div class="line alt1"><code class="number">13.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="comments"># in what direction is the target l1?</code></span></span></div><div class="line alt2"><code class="number">14.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="comments"># were we really sure? if so, don't change too much.</code></span></span></div><div class="line alt1"><code class="number">15.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="plain">gradInput </code><code class="keyword">=</code> <code class="plain">net.backward(X, gradOutput)</code></span></span></div><div class="line alt2"><code class="number">16.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;">&nbsp;</span></span></div><div class="line alt1"><code class="number">17.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="comments"># lets update our weights</code></span></span></div><div class="line alt2"><code class="number">18.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="plain">net.updateParameters(</code><code class="value">1</code><code class="plain">)</code></span></span></div><div class="line alt1"><code class="number">19.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;">&nbsp;</span></span></div><div class="line alt2"><code class="number">20.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="keyword">if</code> <code class="plain">(j</code><code class="keyword">%</code> <code class="value">200</code><code class="plain">) </code><code class="keyword">=</code><code class="keyword">=</code> <code class="value">0</code><code class="plain">:</code></span></span></div><div class="line alt1"><code class="number">21.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 96px;"><code class="keyword">print</code><code class="plain">(</code><code class="string">"Error:"</code> <code class="keyword">+</code> <code class="plain">str(loss))</code></span></span></div></div></div>

<p>And now for the training of the network. I have annotated each 
section of the code with near identical annotations as the numpy 
network. In this way, if you look at them side by side, you should be 
able to see where each operation in the numpy network occurs in the 
PyTorch network.</p>

<p>One part might not look familiar. The "net.zeroGradParameters()" 
basically just zeros out all our "delta" matrices before a new 
iteration. In our numpy network, this was the l2_delta variable and 
l1_delta variable. PyTorch re-uses the same memory allocations each time
 you forward propgate / back propagate (to be efficient, similar to what
 was mentioned in the Matrices section), so in order to keep from 
accidentally re-using the gradients from the prevoius iteration, you 
need to re-set them to 0. This is also a standard practice for most 
popular deep learning frameworks.</p>

<p>Finally, Torch also separates your "loss" from your "gradient". In 
our (somewhat oversimplified) numpy network, we just computed an "error"
 measure. As it turns out, your pure "error" and "delta" are actually 
slightly different measures. (delta is the derivative of the error). 
Again, for deeper coverage, see Chatper 4 of <a href="https://www.manning.com/books/grokking-deep-learning">GDL</a>.

</p><p><b>Putting it all together</b></p>
<div class="syntaxhighlighter " id="highlighter_654225"><div class="bar"><div class="toolbar"><a href="#viewSource" title="view source" style="width: 16px; height: 16px;" class="item viewSource">view source</a><a href="#printSource" title="print" style="width: 16px; height: 16px;" class="item printSource">print</a><a href="#about" title="?" style="width: 16px; height: 16px;" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><code class="number">01.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="keyword">import</code> <code class="plain">PyTorch</code></span></span></div><div class="line alt2"><code class="number">02.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="keyword">from</code> <code class="plain">PyTorchAug </code><code class="keyword">import</code> <code class="plain">nn</code></span></span></div><div class="line alt1"><code class="number">03.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="keyword">from</code> <code class="plain">PyTorch </code><code class="keyword">import</code> <code class="plain">np</code></span></span></div><div class="line alt2"><code class="number">04.</code><span class="content"><span class="block" style="margin-left: 0px;">&nbsp;</span></span></div><div class="line alt1"><code class="number">05.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="comments"># randomly initialize our weights with mean 0</code></span></span></div><div class="line alt2"><code class="number">06.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">net </code><code class="keyword">=</code> <code class="plain">nn.Sequential()</code></span></span></div><div class="line alt1"><code class="number">07.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">net.add(nn.Linear(</code><code class="value">3</code><code class="plain">, </code><code class="value">4</code><code class="plain">))</code></span></span></div><div class="line alt2"><code class="number">08.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">net.add(nn.Sigmoid())</code></span></span></div><div class="line alt1"><code class="number">09.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">net.add(nn.Linear(</code><code class="value">4</code><code class="plain">, </code><code class="value">1</code><code class="plain">))</code></span></span></div><div class="line alt2"><code class="number">10.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">net.add(nn.Sigmoid())</code></span></span></div><div class="line alt1"><code class="number">11.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">net.float()</code></span></span></div><div class="line alt2"><code class="number">12.</code><span class="content"><span class="block" style="margin-left: 0px;">&nbsp;</span></span></div><div class="line alt1"><code class="number">13.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">X </code><code class="keyword">=</code> <code class="plain">np.array([[</code><code class="value">0</code><code class="plain">,</code><code class="value">0</code><code class="plain">,</code><code class="value">1</code><code class="plain">],</code></span></span></div><div class="line alt2"><code class="number">14.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px;"><code class="plain">[</code><code class="value">0</code><code class="plain">,</code><code class="value">1</code><code class="plain">,</code><code class="value">1</code><code class="plain">],</code></span></span></div><div class="line alt1"><code class="number">15.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px;"><code class="plain">[</code><code class="value">1</code><code class="plain">,</code><code class="value">0</code><code class="plain">,</code><code class="value">1</code><code class="plain">],</code></span></span></div><div class="line alt2"><code class="number">16.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px;"><code class="plain">[</code><code class="value">1</code><code class="plain">,</code><code class="value">1</code><code class="plain">,</code><code class="value">1</code><code class="plain">]]).astype(</code><code class="string">'float32'</code><code class="plain">)</code></span></span></div><div class="line alt1"><code class="number">17.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 192px;">&nbsp;</span></span></div><div class="line alt2"><code class="number">18.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">y </code><code class="keyword">=</code> <code class="plain">np.array([[</code><code class="value">0</code><code class="plain">],</code></span></span></div><div class="line alt1"><code class="number">19.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px;"><code class="plain">[</code><code class="value">1</code><code class="plain">],</code></span></span></div><div class="line alt2"><code class="number">20.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px;"><code class="plain">[</code><code class="value">1</code><code class="plain">],</code></span></span></div><div class="line alt1"><code class="number">21.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 144px;"><code class="plain">[</code><code class="value">0</code><code class="plain">]]).astype(</code><code class="string">'float32'</code><code class="plain">)</code></span></span></div><div class="line alt2"><code class="number">22.</code><span class="content"><span class="block" style="margin-left: 0px;">&nbsp;</span></span></div><div class="line alt1"><code class="number">23.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">crit </code><code class="keyword">=</code> <code class="plain">nn.MSECriterion()</code></span></span></div><div class="line alt2"><code class="number">24.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="plain">crit.float()</code></span></span></div><div class="line alt1"><code class="number">25.</code><span class="content"><span class="block" style="margin-left: 0px;">&nbsp;</span></span></div><div class="line alt2"><code class="number">26.</code><span class="content"><span class="block" style="margin-left: 0px;"><code class="keyword">for</code> <code class="plain">j </code><code class="keyword">in</code> <code class="plain">range(</code><code class="value">2400</code><code class="plain">):</code></span></span></div><div class="line alt1"><code class="number">27.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;">&nbsp;</span></span></div><div class="line alt2"><code class="number">28.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="plain">net.zeroGradParameters()</code></span></span></div><div class="line alt1"><code class="number">29.</code><span class="content"><span class="block" style="margin-left: 0px;">&nbsp;</span></span></div><div class="line alt2"><code class="number">30.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="comments"># Feed forward through layers 0, 1, and 2</code></span></span></div><div class="line alt1"><code class="number">31.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="plain">output </code><code class="keyword">=</code> <code class="plain">net.forward(X)</code></span></span></div><div class="line alt2"><code class="number">32.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;">&nbsp;</span></span></div><div class="line alt1"><code class="number">33.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="comments"># how much did we miss the target value?</code></span></span></div><div class="line alt2"><code class="number">34.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="plain">loss </code><code class="keyword">=</code> <code class="plain">crit.forward(output, y)</code></span></span></div><div class="line alt1"><code class="number">35.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="plain">gradOutput </code><code class="keyword">=</code> <code class="plain">crit.backward(output, y)</code></span></span></div><div class="line alt2"><code class="number">36.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;">&nbsp;</span></span></div><div class="line alt1"><code class="number">37.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="comments"># how much did each l1 value contribute to the l2 error (according to the weights)?</code></span></span></div><div class="line alt2"><code class="number">38.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="comments"># in what direction is the target l1?</code></span></span></div><div class="line alt1"><code class="number">39.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="comments"># were we really sure? if so, don't change too much.</code></span></span></div><div class="line alt2"><code class="number">40.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="plain">gradInput </code><code class="keyword">=</code> <code class="plain">net.backward(X, gradOutput)</code></span></span></div><div class="line alt1"><code class="number">41.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;">&nbsp;</span></span></div><div class="line alt2"><code class="number">42.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="comments"># lets update our weights</code></span></span></div><div class="line alt1"><code class="number">43.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="plain">net.updateParameters(</code><code class="value">1</code><code class="plain">)</code></span></span></div><div class="line alt2"><code class="number">44.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;">&nbsp;</span></span></div><div class="line alt1"><code class="number">45.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 48px;"><code class="keyword">if</code> <code class="plain">(j</code><code class="keyword">%</code> <code class="value">200</code><code class="plain">) </code><code class="keyword">=</code><code class="keyword">=</code> <code class="value">0</code><code class="plain">:</code></span></span></div><div class="line alt2"><code class="number">46.</code><span class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span class="block" style="margin-left: 96px;"><code class="keyword">print</code><code class="plain">(</code><code class="string">"Error:"</code> <code class="keyword">+</code> <code class="plain">str(loss))</code></span></span></div></div></div>

<pre>Error:0.2521711587905884
Error:0.2500123083591461
Error:0.249952495098114
Error:0.24984735250473022
Error:0.2495250701904297
Error:0.2475520819425583
Error:0.22693687677383423
Error:0.13267411291599274
Error:0.04083901643753052
Error:0.016316475346684456
Error:0.008736669085919857
Error:0.005575092509388924
</pre>

<p>Your results may vary a bit. I do not yet see how random numbers are 
to be seeded. If I come across that in the future, I'll add an edit.</p>


<hr>
<script async="" src="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/adsbygoogle.js"></script>
<!-- Part 1 -->
<ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-6751104560361558" data-ad-slot="2365390629" data-adsbygoogle-status="done"><ins id="aswift_3_expand" style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent"><ins id="aswift_3_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_3" name="aswift_3" style="left:0;position:absolute;top:0;" width="728" height="90" frameborder="0"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<hr>


<h2 class="section-heading">Part 4: The State of PyTorch</h2>

<p>While still a new framework with lots of ground to cover to close the
 gap with its competitors, PyTorch already has a lot to offer. It looks 
like there's an LSTM test case in the works, and strong promise for 
building custom layers in .lua files that you can import into Python 
with some simple wrapper functions. If you want to build feedforward 
neural networks using the industry standard Torch backend without having
 to deal with Lua, PyTorch is what you're looking for. If you want to 
build custom layers or do some heavy sequence2sequence models, I think 
the framework will be there very soon (with documentation / test cases 
to describe best practices). Overall, I'm very excited to see where this
 framework goes, and I encourage you to <a href="https://github.com/hughperkins/pytorch">Star/Follow it on Github</a></p>

<p><b>For New Readers:</b> I typically tweet out new blogposts when they're complete at <a href="https://twitter.com/iamtrask">@iamtrask</a>.
 Feel free to follow if you'd be interested in reading more in the 
future and thanks for all the upvotes on hacker news and reddit!
</p>

<link rel="stylesheet" type="text/css" href="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/shCore.css">
<link rel="stylesheet" type="text/css" href="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/shThemeDefault.css">
<script src="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/shCore.js"></script>
<script src="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/shLegacy.js"></script>
<script src="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/shBrushPython.js"></script>
<script type="text/javascript">
	// SyntaxHighlighter.config.bloggerMode = true;
	SyntaxHighlighter.config.toolbar = true;
    SyntaxHighlighter.all();
</script>
<p></p><p></p><p></p><p></p>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="https://2016/08/17/grokking-deep-learning/" data-toggle="tooltip" data-placement="top" title="" data-original-title="Grokking Deep Learning"> Previous Post</a> 
                    </li>
                     
                     
                </ul>

            </div>
        </div>
    </div>
</article>




    <!-- Footer -->
<footer>

    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="https://iamtrask.github.io/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/iamtrask">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/iamtrask">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright  i am trask 2017</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/jquery.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/bootstrap.js"></script>

<!-- Custom Theme JavaScript -->
<script src="Tutorial:%20Deep%20Learning%20in%20PyTorch%20-%20i%20am%20trask_files/clean-blog.js"></script>





</body></html>